## 2.1 함수를 값으로 다루기

함수형 프로그래밍(Functional Programming, FP)의 핵심 개념 중 하나는 **함수를 다른 값처럼 다루는 것**입니다. 이는 함수가 숫자, 문자열, 객체 등과 동일하게 변수에 할당되거나, 다른 함수의 인자로 전달되거나, 심지어 다른 함수의 반환 값으로 사용될 수 있음을 의미합니다. 이러한 특성 덕분에 함수형 프로그래밍은 코드를 더욱 유연하고 모듈화하며 재사용 가능하게 만듭니다.

파이썬은 다중 패러다임 언어로서 절차적, 객체 지향적, 함수형 프로그래밍 스타일을 모두 지원하며, 함수를 값으로 다루는 기능은 파이썬에서 함수형 스타일의 코드를 작성하는 중요한 기반이 됩니다.

### 파이썬의 함수 객체

파이썬에서 함수는 단순한 코드 블록이 아니라, **`함수 객체(function object)`**입니다. 이는 함수를 다른 종류의 데이터(예: 문자열, 숫자)처럼 취급할 수 있다는 것을 의미합니다.

- **변수에 할당**: 함수는 변수에 할당될 수 있습니다. 이렇게 하면 여러 변수가 동일한 함수 객체를 참조할 수 있습니다. 예를 들어, `say_hello`라는 함수를 정의하고 이를 `greet_func`이라는 변수에 할당할 수 있습니다.
    
    ```
    def say_hello(name):
        return f"안녕하세요, {name}님!"
    
    greet_func = say_hello
    print(greet_func("김철수"))
    # 출력: 안녕하세요, 김철수님!
    ```
    
    이 예시에서 `greet_func`은 `say_hello` 함수 객체를 참조하는 또 다른 이름(별칭)이 됩니다. 함수 참조를 변경하면 해당 함수를 사용하는 다른 코드의 동작이 간접적으로 변경될 수도 있습니다.
    
- **다른 함수의 인자로 전달**: 함수는 다른 함수의 인자로 전달될 수 있습니다. 이를 통해 **`고차 함수(higher-order function)`**를 생성할 수 있는데, 고차 함수는 하나 이상의 함수를 인자로 받거나 함수를 반환하는 함수를 말합니다. 파이썬의 내장 함수 중 `sorted()` 함수는 `key` 인자에 함수를 받아 정렬 기준을 사용자 정의할 수 있게 해주는 대표적인 예시입니다.
    
    ```
    직원_목록 = [
        ('김철수', 30),
        ('박영희', 25),
        ('이민준', 35)
    ]
    
    def get_name(employee):
        return employee[0] # 이름을 반환하도록 수정
    
    def get_age(employee):
        return employee[1] # 나이를 반환하도록 수정
    
    # 이름을 기준으로 정렬
    by_name = sorted(직원_목록, key=get_name)
    print(by_name)
    # 출력: [('김철수', 30), ('박영희', 25), ('이민준', 35)]
    
    # 나이를 기준으로 정렬
    by_age = sorted(직원_목록, key=get_age)
    print(by_age)
    # 출력: [('박영희', 25), ('김철수', 30), ('이민준', 35)]
    ```
    
    위 코드에서 `get_name`과 `get_age` 함수는 `sorted()` 함수의 `key` 인자로 전달되어 정렬 동작을 맞춤 설정합니다. 이는 함수가 단순히 값을 계산하는 것을 넘어, 프로그램의 동작 방식을 유연하게 조작하는 데 사용될 수 있음을 보여줍니다.
    
- **다른 함수의 반환 값으로 사용**: 함수는 다른 함수의 반환 값으로도 사용될 수 있습니다. 이는 **`클로저(closure)`** 개념과 밀접하게 연관되어 있으며, 특정 상태를 "기억"하는 함수를 만들 수 있게 해줍니다. 예를 들어, 특정 증분 값으로 숫자를 증가시키는 함수를 생성하는 `create_increment_function` 함수를 만들 수 있습니다.
    
    ````
    def create_increment_function(step=1):
        # 이 내부 함수는 외부 함수의 'step' 변수를 참조합니다 (클로저)
        def increment(x):
            return x + step
        return increment
    
    add_one = create_increment_function()    # step=1로 설정된 increment 함수 반환
    add_two = create_increment_function(step=2) # step=2로 설정된 increment 함수 반환
    
    print(add_one(5)) # 출력: 6
    print(add_two(5)) # 출력: 7
    ```create_increment_function`은 `increment`라는 **내부 함수를 반환**하며, 이 내부 함수는 `step` 값(외부 함수 스코프에서 정의된)을 기억하여 호출될 때마다 해당 `step`만큼 값을 증가시킵니다. 이러한 유연성 덕분에 파이썬은 함수형 프로그래밍 개념을 효과적으로 구현할 수 있습니다.
    
    
    ````
    

### 람다(Lambda) 표현식: 익명 함수 생성

**`람다(lambda)`** 표현식은 파이썬에서 작고 **`익명 함수(anonymous function)`**를 생성하는 간결한 방법입니다. 이름이 없기 때문에 코드 내에서 즉시 사용되거나 다른 함수의 인자로 전달될 때 유용합니다. 람다는 함수형 프로그래밍 언어인 하스켈(Haskell)에서 차용한 문법입니다.

람다 함수의 기본 구조는 다음과 같습니다: `lambda 인자들: 표현식`

- **간결한 함수 생성**: 람다는 단일 표현식으로 계산될 수 있는 간단한 함수를 정의할 때 주로 사용됩니다. 이는 여러 줄의 로직이나 복잡한 조건문이 필요 없는 경우 `def` 키워드를 사용하는 것보다 더 간결합니다.
    
    ```
    # 두 숫자를 더하는 람다 함수
    adder = lambda x, y: x + y
    print(adder(3, 5))
    # 출력: 8
    
    # 숫자의 제곱을 계산하는 람다 함수
    square = lambda x: x ** 2
    print(square(4))
    # 출력: 16
    ```
    
    람다 함수는 정의와 동시에 호출할 수도 있습니다.
    
    ```
    print((lambda x: x ** 2)(5))
    # 출력: 25
    ```
    
- **고차 함수와 함께 사용**: 람다는 `map()`, `filter()`, `sorted()`와 같은 고차 함수의 `key` 인자나 콜백 함수로 특히 유용하게 사용됩니다.
    
    ```
    점수_목록 = [30, 25, 40]
    최대_점수 = 50
    
    # 각 점수를 등급으로 변환하는 람다 함수를 map에 적용
    # 스위스 등급: 1..6
    등급_목록 = list(map(lambda score: score / 최대_점수 * 5 + 1, 점수_목록))
    print(등급_목록)
    # 출력: [4.0, 3.5, 5.0]
    ```
    
    위 예시에서 `lambda score: score / 최대_점수 * 5 + 1`는 등급 계산을 위한 익명 함수로 `map()`에 전달됩니다. 이를 통해 별도의 `def` 문 없이 간결하게 변환 로직을 표현할 수 있습니다.
    
- **람다의 한계 및 권장 사항**: 람다는 오직 **단일 표현식(single expression)**만 포함할 수 있습니다. 이는 여러 문장으로 구성된 복잡한 로직이나 `if/else`, `try/except`와 같은 제어 흐름이 필요한 경우에는 사용할 수 없다는 의미입니다. 과도하게 복잡한 람다 표현식은 가독성을 해칠 수 있으므로 피하는 것이 좋습니다. 파이썬 커뮤니티에서는 일반적으로 람다를 지나치게 많이 사용하기보다는 명확한 이름의 일반 함수(`def` 문 사용)를 선호하는 경향이 있습니다. Fredrik Lundh는 람다 리팩토링에 대한 다음과 같은 규칙을 제안했습니다:
    
    1. 람다 함수를 작성합니다.
        
    2. 그 람다 함수가 무엇을 하는지 설명하는 주석을 작성합니다.
        
    3. 그 주석을 잠시 연구하고, 주석의 본질을 포착하는 이름을 생각해냅니다.
        
    4. 그 이름을 사용하여 람다를 `def` 문으로 변환합니다.
        
    5. 주석을 제거합니다. 이러한 지침은 코드의 명확성과 유지보수성을 높이는 데 도움이 됩니다.
        

### `operator` 모듈: 간단한 연산자 함수 사용

파이썬의 **`operator` 모듈**은 산술, 비교, 비트 연산, 객체 식별 등 파이썬의 **내장 연산자에 해당하는 함수들을 제공**합니다. 이 모듈의 함수들은 함수형 스타일의 코드를 작성할 때, 간단한 연산을 위해 별도의 람다 함수를 정의할 필요를 없애주어 코드를 더욱 간결하고 읽기 쉽게 만듭니다.

- **람다 대체**: `operator` 모듈의 함수들은 특정 연산을 수행하는 간단한 람다 표현식을 대체하는 데 아주 효과적입니다. 예를 들어, 두 숫자를 더하거나 곱하는 간단한 `calculate` 함수를 정의할 때, 람다 대신 `operator.add`나 `operator.mul`을 사용할 수 있습니다.
    
    ```
    import operator
    
    def calculate(op, a, b):
        return op(a, b)
    
    # 람다 대신 operator.add 사용
    print(calculate(operator.add, 3, 1))
    # 출력: 4
    
    # 람다 대신 operator.mul 사용
    print(calculate(operator.mul, 3, 2))
    # 출력: 6
    ```
    
    이 예시는 `operator` 모듈이 어떻게 코드를 더 깔끔하게 만들 수 있는지 보여줍니다.
    
- **주요 `operator` 함수**: `operator` 모듈에는 다양한 범주의 함수들이 포함되어 있습니다:
    
    - **수학 연산**: `add()`, `sub()`, `mul()`, `floordiv()`, `abs()` 등.
        
    - **논리 연산**: `not_()`, `truth()` 등.
        
    - **비트 연산**: `and_()`, `or_()`, `invert()` 등.
        
    - **비교 연산**: `eq()`, `ne()`, `lt()`, `le()`, `gt()`, `ge()` 등.
        
    - **객체 식별**: `is_()`, `is_not()` 등.
        
    - **항목/속성 접근**: `itemgetter()`, `attrgetter()`, `methodcaller()` 등. 이들은 리스트나 딕셔너리의 특정 요소 또는 객체의 속성을 효율적으로 가져오거나 메서드를 호출하는 함수를 반환하여 `sorted()`함수의 `key` 인자 등으로 활용될 수 있습니다.
        
        ```
        from operator import itemgetter
        
        직원_목록 = [
            ('김철수', 30, 7000),
            ('박영희', 25, 5000),
            ('이민준', 35, 9000)
        ]
        
        # 연봉(인덱스 2)을 기준으로 정렬
        by_salary = sorted(직원_목록, key=itemgetter(2))
        print(by_salary)
        # 출력: [('박영희', 25, 5000), ('김철수', 30, 7000), ('이민준', 35, 9000)]
        ```
        
        `itemgetter(2)`는 튜플의 세 번째 요소(인덱스 2)를 반환하는 함수 객체를 생성하여, `sorted()` 함수가 연봉을 기준으로 정렬하도록 합니다.
        

결론적으로, 파이썬에서 함수를 값으로 다루는 능력은 람다 표현식, `operator` 모듈과 같은 도구들을 통해 크게 강화됩니다. 이러한 기능들은 개발자가 더욱 간결하고 유연하며 재사용 가능한 코드를 작성할 수 있도록 지원하며, 파이썬에서 효과적인 함수형 프로그래밍을 가능하게 합니다.